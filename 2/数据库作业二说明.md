# æ•°æ®åº“ä½œä¸šäºŒè¯´æ˜
## ä¸€ä¸ªç®€å•çš„å‘½ä»¤è¡Œå°å·¥å…·
## ERå›¾
![](img/ER.png)
## æ“ä½œåŠç›¸å…³å‘½ä»¤
### å¢åŠ ç”¨æˆ·

	add user [username] [password]
	e.g add user é™ˆæŒ¯å®‡ 123456

å¯¹åº”ä»£ç æ®µ: dao.UserDAO.addUser(String username, String password)æ–¹æ³•

	
### æŸ¥è¯¢å¥—é¤

	search buddle [username]
	
	e.g: search buddle é™ˆæŒ¯å®‡
å¯¹åº”ä»£ç æ®µ: dao.BuddleDAO.listBundleByUsername(String username)

### è®¢è´­å¥—é¤
#### è®¢è´­å¥—é¤å¹¶ç«‹å³ç”Ÿæ•ˆ

		order imm [buddleType] [username] [period]
		
		e.g:  order imm call é™ˆæŒ¯å®‡ 2
		å³ç”¨æˆ·é™ˆæŒ¯å®‡è®¢è´­ç”µè¯å¥—é¤2æœˆå¹¶ç«‹å³ç”Ÿæ•ˆ
å¯¹åº”ä»£ç æ®µ: dao.BuddleDAO.addBundleImmediately(BundleType bundleType, String username, int period)
#### è®¢è´­å¥—é¤å¹¶æ¬¡æœˆç”Ÿæ•ˆ

		order next [buddleType] [username] [period]
		e.g: order next sms é™ˆæŒ¯å®‡ 3
		å³ç”¨æˆ·é™ˆæŒ¯å®‡è®¢è´­çŸ­ä¿¡å¥—é¤3æœˆå¹¶æ¬¡æœˆç”Ÿæ•ˆ
å¯¹åº”ä»£ç æ®µ: dao.BuddleDAO.addBundleNextMonth(BundleType bundleType, String username, int period)

**è§„å®šå¥—é¤ç±»å‹åœ¨å‘½ä»¤è¡Œä¸­çš„è¾“å…¥**

- call ç”µè¯å¥—é¤
- sms çŸ­ä¿¡å¥—é¤
- local æœ¬åœ°æµé‡å¥—é¤
- dome å›½å†…æµé‡å¥—é¤



#### é€€è®¢å¥—é¤å¹¶ç«‹å³ç”Ÿæ•ˆ

		deorder imm [username] [buddleId]
		
		e.g: deorder imm [åˆ˜å˜‰] [4]
		å³ç”¨æˆ·åˆ˜å˜‰ç«‹å³é€€è®¢idä¸º4çš„å¥—é¤

å¯¹åº”ä»£ç æ®µ: dao.BuddleDAO.removeBundleImmediately(String username, int buddleId)

#### é€€è®¢å¥—é¤å¹¶æ¬¡æœˆç”Ÿæ•ˆ

		deorder next [username] [buddleId]
		
		e.g: deorder next [åˆ˜å˜‰] [5]
		å³ç”¨æˆ·åˆ˜å˜‰é€€è®¢idä¸º4çš„å¥—é¤ï¼Œæ¬¡æœˆç”Ÿæ•ˆ

å¯¹åº”ä»£ç æ®µ: dao.BuddleDAO.removeBundleUntilNextMonth(String username, int buddleId)

### èµ„è´¹ç”Ÿæˆ

#### é€šè¯

		fee call [username] [callUsage]
		
		e.g: fee call é™ˆæŒ¯å®‡ 10
		å³ç”¨æˆ·é™ˆæŒ¯å®‡æ‰“äº†10åˆ†é’Ÿç”µè¯ï¼Œæ˜¾ç¤ºè¯è´¹è´¹ç”¨å’Œå¥—é¤æç¤º
å¯¹åº”ä»£ç æ®µ: dao.ConsumptionDAO.addCallUsage(String username, double callUsage)
		

#### çŸ­ä¿¡
	
		fee sms [username] [SMSAmount]
		
		e.g: fee sms åˆ˜å˜‰ 20
		å³ç”¨æˆ·åˆ˜å˜‰ä¸€æ¬¡ç¾¤å‘äº†20æ¡çŸ­ä¿¡ï¼Œæ˜¾ç¤ºçŸ­ä¿¡è´¹ç”¨å’Œå¥—é¤æç¤º

å¯¹åº”ä»£ç æ®µ: dao.ConsumptionDAO.addSMSUsage(String username, int SMSAmount)

#### æœ¬åœ°æµé‡
		
		fee local [username] [localDataUsage]
		
		e.g: fee local é™ˆæŒ¯å®‡ 500
		å³ç”¨æˆ·é™ˆæŒ¯å®‡ä¸€æ¬¡ä½¿ç”¨äº†500Mæœ¬åœ°æµé‡ï¼Œæ˜¾ç¤ºæµé‡è´¹ç”¨å’Œå¥—é¤æç¤º
å¯¹åº”ä»£ç æ®µ: dao.ConsumptionDAO.addLocalDataUsage(String username, double localDataUsage)

#### å›½å†…æµé‡ 	

		fee dome[username] [domesticDataUsage]
		
		e.g: fee dome åˆ˜å˜‰ 800
		å³ç”¨æˆ·åˆ˜å˜‰ä¸€æ¬¡ä½¿ç”¨äº†800Mæµé‡ï¼Œæ˜¾ç¤ºæµé‡è´¹ç”¨åŠå¥—é¤æç¤º
å¯¹åº”ä»£ç æ®µ: dao.ConsumptionDAO.addDomesticDataUsage(String username, double domesticDataUsage)


### ç”Ÿæˆè´¦å•

		bill [dateToMonth] [username]
		
		e.g: bill 2018-10 é™ˆæŒ¯å®‡
		å³æ˜¾ç¤ºç”¨æˆ·é™ˆæŒ¯å®‡åœ¨2018å¹´10æœˆçš„è´¦å•è¯¦ç»†ä¿¡æ¯ï¼ŒåŒ…æ‹¬ç”µè¯ã€çŸ­ä¿¡ã€æµé‡çš„ä½¿ç”¨åŠå¥—é¤æƒ…å†µï¼Œè´¦æˆ·è¯è´¹åŠè´¦æˆ·ä½™é¢

 å¯¹åº”ä»£ç æ®µ: dao.BillDAO.addBill(String date, String username)
 
 
### å……å€¼
	topup [username] [amount]
	
	e.g: topup åˆ˜å˜‰ 100
	å³åˆ˜å˜‰å……å€¼100
 
 
## Demo
### å¢åŠ ç”¨æˆ·

	add user æ½˜ç¾½ admin
	
![](img/1.png)

### æŸ¥è¯¢å¥—é¤
	
	search buddle æ½˜ç¾½
![](img/2.png)

### è®¢è´­å¥—é¤(ç«‹å³ç”Ÿæ•ˆ)

	order imm call æ½˜ç¾½ 1

![](img/3_1.png)

**æ­¤æ—¶æŸ¥è¯¢ç”¨æˆ·æ½˜ç¾½çš„å¥—é¤ä¿¡æ¯**

	search buddle æ½˜ç¾½

![](img/3_2.png)
æ­¤æ—¶ä»å½“å¤©(2018-10-25)è®¢è´­ä¸€ä¸ªæœˆåˆ°2018-11-25

### è®¢è´­å¥—é¤(æ¬¡æœˆç”Ÿæ•ˆ)

	order next sms æ½˜ç¾½ 2
	
![](img/4_1.png)
**æ­¤æ—¶ç»§ç»­æŸ¥è¯¢ç”¨æˆ·æ½˜ç¾½çš„å¥—é¤ä¿¡æ¯**
		
	search buddle æ½˜ç¾½
	
![](img/4_2.png)
æ­¤æ—¶å¤šäº†ä¸€ä¸ªå¥—é¤æ˜¯ä»ä¸‹ä¸ªæœˆ11-01å¼€å§‹åˆ°2019-01-01ç»“æŸçš„

**æ­¤æ—¶æŸ¥çœ‹ä¸€ä¸‹ç”¨æˆ·çš„è´¦æˆ·ä½™é¢**

	check æ½˜ç¾½
![](img/4_3.png)

ä½™é¢ä¸ºåˆå§‹0 - 20 - 0 = -20

###  ç§»é™¤å¥—é¤(ç«‹å³ç”Ÿæ•ˆ)
	deorder imm æ½˜ç¾½ 1
![](img/5_1.png)
æŸ¥çœ‹ç”¨æˆ·æ½˜ç¾½æ­¤æ—¶åªæœ‰å¥—é¤äºŒ
![](img/5_2.png)
### ç§»é™¤å¥—é¤(æ¬¡æœˆç”Ÿæ•ˆ)
	deorder next æ½˜ç¾½ 2!
![](img/6_1.png)
æŸ¥çœ‹ç”¨æˆ·æ½˜ç¾½æ­¤æ—¶è®¢å•ç»“æŸæ—¥æœŸä¸º2018-10-31
![](img/6_2.png)

## ä¸­é—´è¿‡ç¨‹
**ä¸ºäº†ä¾¿äºçœ‹å‡ºç”¨æˆ·å¥—é¤å¯¹ç»“æœç»“æœï¼Œæˆ‘ä»¬å¢åŠ ç”¨æˆ·åˆ˜å˜‰å’Œé™ˆæŒ¯å®‡ğŸ˜**
### æµç¨‹

1. å¢åŠ ç”¨æˆ·åˆ˜å˜‰ï¼Œé™ˆæŒ¯å®‡ï¼Œå¹¶ä¸ºä»–ä»¬å„å……å€¼1000å…ƒ
2. åˆ˜å˜‰è®¢è´­ç”µè¯å¥—é¤ * 1(1ä¸ªæœˆç«‹å³ç”Ÿæ•ˆ)ï¼ŒçŸ­ä¿¡å¥—é¤ * 1(2ä¸ªæœˆç«‹å³ç”Ÿæ•ˆ)
3. é™ˆæŒ¯å®‡è®¢è´­æœ¬åœ°æµé‡å¥—é¤ * 1(2ä¸ªæœˆç«‹å³ç”Ÿæ•ˆ)ï¼Œå›½å†…æµé‡å¥—é¤ * 1 (3ä¸ªæœˆæ¬¡æœˆç”Ÿæ•ˆ)
4. åˆ˜å˜‰è¿›è¡Œé€šè¯100åˆ†é’Ÿï¼Œä¸€æ¬¡ç¾¤å‘äº†300æ¡çŸ­ä¿¡
5. é™ˆæŒ¯å®‡ä½¿ç”¨æœ¬åœ°æµé‡100Mï¼Œå›½é™…æµé‡1G

### å‘½ä»¤æ‰§è¡Œæ®µ
		 add user åˆ˜å˜‰ 123456
		 add user é™ˆæŒ¯å®‡ 123456
		 topup åˆ˜å˜‰ 1000
		 topup é™ˆæŒ¯å®‡ 1000
		 order imm call åˆ˜å˜‰ 1
		 order imm sms åˆ˜å˜‰ 2
		 order imm local é™ˆæŒ¯å®‡ 1000
		 order next dome é™ˆæŒ¯å®‡ 3000
		 fee call åˆ˜å˜‰ 100
		 fee sms åˆ˜å˜‰ 300
		 fee local é™ˆæŒ¯å®‡ 100
		 fee dome é™ˆæŒ¯å®‡ 1000
		 bill 2018-10 åˆ˜å˜‰
		 bill 2018-10 é™ˆæŒ¯å®‡
		 
		 

### å®æ—¶ç”µè¯è´¹ç”¨ç”Ÿæˆ

	fee call åˆ˜å˜‰ 100
![](img/7.png)
	
### å®æ—¶çŸ­ä¿¡è´¹ç”¨ç”Ÿæˆ
	fee sms åˆ˜å˜‰ 300
![](img/8.png)
### å®æ—¶æœ¬åœ°æµé‡è´¹ç”¨ç”Ÿæˆ
	fee local é™ˆæŒ¯å®‡ 100
![](img/9.png)
### å®æ—¶å›½å†…æµé‡è´¹ç”¨ç”Ÿæˆ
	fee dome é™ˆæŒ¯å®‡ 1000
![](img/10.png)
### æœˆè´¦å•ç”Ÿæˆ
	bill 2018-10 åˆ˜å˜‰
	
1000 - 20 - 10 - (300 - 200) * 0.1 = 960
![](img/11.png)

	 bill 2018-10 é™ˆæŒ¯å®‡
![](img/12.png)

1000 - 20 - 0 - (1000 - 0) * 3 = -2020

ğŸ™„è¿™ç§æ¬ å·¨å¤šçš„...

## é™„åŠ è¯´æ˜

