# 1
select pname, volume from Production, Deal
where Production.pid = Deal.pid 
order by volume desc
limit 2



# 2
select pname, volume from Production p, Deal d 
where p.pid = d.pid and p.pdate >= str_to_date('2017-1-1', 'yyyy-mm-dd');




# 3
select sname, aname from Sales s, Agent a
where s.aid = a.aid and s.sid in (
	select sid from Deal d where d.pid = 2
    and d.volume > 100
);




# 4
select aname, pname, volume 
from Agent a, Production p, Deal d, Sales s
where d.pid =  p.pid and d.sid = s.sid and a.aid = s.aid

 
# 5

select pname, count(pid) from Production p, Deal d
where p.pid = d.pid and p.pid in (select pid, count(pid) from 
	Deal group by pid
);

# 6
select aname, sname from Agent a, Sales s 
where a.aid = s.aid and a.aid = (
	select aid from Agent where aname like '%BBB%'
);

# 7

select pname, volume from Production, Deal
where Production.pid = Deal.pid 
order by volume asc
limit 1

# 8
select pname, sname, volumn
  from Production, Sales, Deal
 where sid in
       (select Sales.sid
          from Deal t1, (select pid, max(volume)a from Deal group by pid) t2
         where t1.pid = t2.pid
           and t1.volume = t2.a)
           and Production.pid = Deal.pid and Deal.sid = Sales.sid;